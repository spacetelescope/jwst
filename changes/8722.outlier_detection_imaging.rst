Split outlier detection into multiple steps for different modes
